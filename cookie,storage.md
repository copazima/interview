# 쿠키/ 세션스토리지/ 로컬스토리지 차이점  

|   |쿠키|세션|
|:------:|:---:|:---:|
|저장 위치|클라이언트(=접속자PC)|웹 서버|
|저장 형식|text|Object|
|만료 시점|쿠키 저장시 설정(브라우저가 종료돼도 만료시점이 지나지 않으면 자동 삭제되지 않음)|브라우저 종료시 삭제(기간 지정 가능)|
|사용하는 자원(리소스)|클라이언트 리소스|웹 서버 리소스|
|용량 제한|총 300개 하나의 도메인당 20개 하나의 쿠키당 4KB=4096byte)|서버가 허용하는 한 용량제한 없음|
|속도|세션보다 빠름|쿠키보다 느림|
|보안|세션보다 안좋음|쿠키보다 좋음|  

# 쿠키  
쿠키란 HTTP의 일종으로서 인터넷 사용자가 어떠한 웹 사이트를 방문할 경우 그 사이트가 사용하고 있는 서버를 통해 인터넷 사용자의 컴퓨터에 설치되는 작은 기록 정보 파일을 일컫는다.  
쿠키는 만료 기간이 있는 키 - 값 저장소이다. 4KB의 용량 제한이 있다.  
* 장점  
대부분의 브라우저에서 지원

* 단점  
1. 매번 서버에 전송되므로 크기가 클 경우 서버에 부담이 갈 수 있다.  
2. SameSite 옵션이 Strict가 아닌 경우, 다른 도메인에서 요청할 때도 자동 전송되는 위험성이 있다. (CSRF 취약)  
---  
## 쿠키의 동작 방식  
1. 클라이언트가 페이지를 요청  
2. 서버에서 쿠키를 생성  
3. HTTP 헤더에 쿠키를 포함 시켜 응답  
4. 브라우저가 종료되어도 쿠키 만료 기간이 있다면 클라이언트에서 보관하고 있음  
5. 같은 요청을 할 경우 HTTP 헤더에 쿠키를 함께 보냄  
6. 서버에서 쿠키를 읽어 이전 상태 정보를 변경 할 필요가 있을 때 쿠키를 업데이트 해 변경된 쿠키를 HTTP 헤더에 포함시켜 응답  

# 세션  
HTTP Session id를 식별자로 구별해 데이터를 사용자의 브라우저에 쿠키형태가 아닌 접속한 서버 DB에 정보를 저장한다. 클라이언트는 HTTP Session id를 쿠키로 메모리 저장된 형태로 가지고 있다. 메모리에 저장하기 때문에 브라우저가 종료되면 사라지게 된다. 쿠키의 트래픽 문제와 쿠키를 변경하는 보안적 이슈를 해결하기 위해 등장하였다.  

---

## 세션의 동작 방식  
1. 클라이언트가 서버에 접속 시 세션 ID를 발급  
2. 클라이언트는 세션 ID에 대해 쿠키를 사용해서 저장하고 가지고 있음  
3. 클라이언트는 서버에 요청할 때 이 쿠키의 세션 ID를 서버에 전달해서 사용  
4. 서버는 세션 ID를 전달받아서 별다른 작업 없이 세션ID로 세션에 있는 클라이언트 정보를 가져옴  
5. 클라이언트 정보를 가지고 서버 요청을 처리 해 클라이언트에게 응답 

> 쿠키의 단점을 보완해 HTML5에서 '웹스토리지' 라는 기술 탄생  

# 웹 스토리지  
web storage는 서버가 아닌 클라이언트에 데이터를 저장할 수 있도록 지원하는 HTML5의 새로운 기능이다. 종류로는 로컬 스토리지와 세션스토리지가 있다. 둘 다 간단한 키와 값을 저장할 수 있다. 키-밸류 스토리지의 형태이다.  
두 스토리지는 모두 window 객체 안에 들어있다. Storage 객체를 상속받기 때문에 메소드가 공통적으로 존재한다. 도메인별 용량 제한도 있다.(프로토콜, 호스트, 포트가 같으면 같은 스토리지를 공유한다.) 모바일은 2.5mb, 데스크탑은 5mb~10mb정도이다. 

# 로컬 스토리지  
로컬스토리지는 브라우저에 반영구적으로 데이터를 저장하며, 브라우저를 종료해도 데이터가 유지된다. 브라우저 자체에 반영구적으로 데이터가 유지되지만 domain이 다른 경우에는 로컬 스토리지에 접근할 수 없다. 예를 들어 www.google.com 에서 로컬 스토리지에 저장한 데이터를 www.ieeexplore.ieee.org에서 접근할 수 없는 것과 같다. 저장되는 데이터의 만료 기간이 없다. 

* 세션과 로컬스토리지의 장점  
1. 서버에 불필요하게 데이터를 저장하지 않음  
2. 용량이 크다.  

* 세션과 로컬스토리지의 단점  
HTML5를 지원하지 않는 브라우저의 경우 사용 불가
 
# 적절한 사용 예
* 자동 로그인: 로컬 스토리지  
* 입력 폼 정보: 세션 스토리지  
* 비로그인 장바구니: 세션 스토리지  
* 다시 보지 않음 팝업 창: 쿠키  

> 참고자료  
[https://tristan91.tistory.com/521]  
[https://it-eldorado.tistory.com/90]  
[https://velog.io/@kler/TIL4-%EB%A1%9C%EC%BB%AC%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80-%EC%84%B8%EC%85%98%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80-%EC%BF%A0%ED%82%A4-%EC%A0%95%EB%A6%AC]  
작성자: 다정  
작성일: 21.6.11
